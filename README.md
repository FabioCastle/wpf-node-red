# WPF Node-RED

Proof of concept of having a WPF application that embeddes a Node-RED installation.

The idea is to build a WPF application that has standard features among every installation (the "core"), while every instance of the app can have custom logics provided by Node-RED flows.
This separates the core product development from client-specific requirements and enables the addition of new features after the installation without having a new build.

In the proposed architecture, you should:
- Develop your core features in the .NET project. This includes the UI/UX of the application as well as background logic. You may add objects that generates data exposed via any communication protocol supported by Node-RED (MQTT, OPC-UA, TCP, UDP, etc.)
- Develop the custom logic in form of Node-RED flows that consume the data generated by the .NET objects. Node-RED allows you to develop any number of flows to handle data and you can add and remove them at runtime.

Of course, you should set the boundary between the core and the custom logic as there is no single right way to do it.

## Features
This is a work-in-progress project. Up to now you can see:
- A single page WPF application that shows a loading message until Node-RED is ready to be used. Node-RED server is launched as a child process and the embedding is performed via WebView2.

Please notice that on my PC it requires up to 20 seconds to load. This time is required by WebView2 to load everything that is required to display the Node-RED website. I will try to hide the loading time by have a welcome page and having the loading in the background.

## Why this matters
I had this idea working on an application aimed at controlling industrial production plants.
In this field you often need to monitor the change in a signal on some equipment that should enable some other signal based on some condition.
Since plants are usually composed of a specific set of machines you often re-use the same .NET objects to read and write data on them.
However, every plant may have a custom logic that requires you to change the code in order to handle it, making challenging if not impossible to re-use the same project for every customer.
Also, having an event-based architecture in .NET is feasible but has some limitations regaring the readability of the codebase and difficulties in debug.
This new architecture should enable me to have a single core application that integrates the machines, while writing event-based custom logic in Node-RED.

## Clone the repo
After cloning the repository, go to the `Runtime` folder and install the Node.js dependencies:
- Type `npm install` in the `nodejs` folder
- Type `..\nodejs\npm.cmd install` in the `node-red` folder

__NOTE:__ You need to have an installation of Node.js on your machine before typing the first command. The second command uses the embedded version of Node.js.

__NOTE:__ This works on Windows only